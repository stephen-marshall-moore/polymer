<!--
@license
Copyright (c) 2015 The Blog Elliptic Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
-->

<dom-module id="post-item">
  <style>
    :host {
      display: block;
    }

    .iron-selected {
      background: #eee;
    }
  </style>
  <template>
    <div id="imp_content"></div>
    <!-- section>
    <iron-selector selected="{{selectedpost}}">
      <template is="dom-repeat" items="{{posts}}">
        <post-item item="{{post}}"/>
      </template>
    </iron-selector>
    </section -->
  </template>

  <script>
    (function () {
      Polymer({
        is: 'post-item',
        properties: {
        slugUrl: {
            type: String,
            observer: 'importFragment',
          },
        },


        importFragment: function() {
          if (app && app.params && app.params.slug) {
            console.log( "importFragment would be here, with: " + this.$.imp_content.id);
            //var link = this.importHref( this.slugUrl + "/index.html",
            var link = this.importHref( "/post/" + app.params.slug + "/index.html",
                function() {
                  if( link.import === null ) {
                    console.log( "nothing to import @ " + link.href );
                  } else {
                    var nodes = Polymer.dom(this.$.imp_content).childNodes;
                    for ( n in nodes ) {
                      Polymer.dom(this.$.imp_content).removeChild(n);
                    }

                    console.log( "appending at: " + this.$.imp_content.id)
                    Polymer.dom(this.$.imp_content).appendChild(link.import.body);
                  }
                },
                function() {
                  console.log("post-item: import error");
                });
          }
        }
      });
    })();
  </script>

</dom-module>
